# AWS 

## EC2
- Elastic Compute Cloud 의 약어

## VPC

### 보안 그룹
- Network Access Control List (NACL) 와 함께 방화벽의 역할을 하는 서비스
- Port 허용
    - 기본적으로 모든 포트 비활성화
    - 선택적으로 트래픽이 지나갈 수 있는 Port 와 Source 를 설정 가능
    - Deny는 불가능 > NACL 에서 가능함
- 인스턴스 단위 (ENI)
    - 하나의 인스턴스에 하나 이상의 SG설정 가능
    - NACL 의 경우 서브넷 단위
    - 설정된 인스턴스는 설정한 모든 SG의 룰을 적용 받음
    - 기본 5개 , 최대 16개까지 적용 가능

### 네트워크 ACL (NACL)
- 보안그룹처럼 방화벽 역할 담당
- 서브넷 단위
- 포트 및 아이피를 직접 DENY 가능
    - 외부 공격을 받는 상황 등 특정 아이피를 블록하고 싶을 때 사용
- 순서대로 규칙 평가 (낮은 숫자부터)
- NACL 규칙
    - 규칙 번호 : 규칙에 부여되는 고유 숫자 (낮은 번호 부터)
    - 유형 : 미리 지정된 프로토콜. 선택 시 AWS에서 잘 알려진 포트 (Well Known Port)이 규칙에 지정됨
    - 프로토콜 : 통신 프로토콜. (TCP , UDP , SMP ...)
    - 포트범위 : 허용 혹은 거부할 포트 범위
    - 소스 : IP 주소의 CIDR 블록 
    - 허용/거부 : 허용 혹은 거부 여부
 
### NAT GateWay
- Amazon Virtual Private Colud (Amazon VPC)의 프라이빗 서브넷에 있는 인스턴스에서 인터넷에 쉽게 연결할 수 있도록 지원하는 서비스
- Private 인스턴스가 외부의 인터넷과 통신하기 위한 통로
- NAT GateWay (관리x)
    - AWS에서 제공하는 서비스
- Nat Instance (관리필요)
    - 단일 EC2 인스턴스
- 모두 서브넷 단위
    - 퍼블릭 서브넷에 있어야함

### Bastian Host (Jump Host)
- 외부에서 사설 네트워크에 접속할 수 있도록 경로 확보
- Private 인스턴스 에 접근하기 위한 EC2 인스턴스
- 퍼블릭 서브넷에 위치해야함 
- 대체 Session Manager 으로 Private Ec2 접속하는 방법 권장







## 서브넷

### 퍼블릭 서브넷
- 외부에서 인터넷을 통해 연결할 수 있는 서브넷
- 인터넷 게이트웨이 (IGW)를 통해 외부의 인터넷과 연결되어 있음
- 안에 위치한 인스턴스에 퍼블릭 IP 부여 가능
- 웹서버, 어플리케이션 서버 등 유저에게 노출되어야 하는 인프라

### 프라이빗 서브넷
- 외부에서 인터넷을 통해 연결할 수 없는 서브넷
- 외부 인터넷으로 경로가 없음
- 퍼블릭 IP 부여 불가능
- 데이터베이스 , 로직 서버 등 외부에 노출 될 필요가 없는 인프라

### 서브넷 IP 사용 갯수
- 사용 가능 IP 숫자는 5개 제외하고 계산
    - ex) 10.0.0.0/24
    - 10.0.0.0 : 네트워크 어드레스
    - 10.0.0.1 : VPC ROUTER
    - 10.0.0.2 : DNS Server
    - 10.0.0.3 : 미래에 사용을 위해 남겨 둠
    - 10.0.0.255(마지막번호) : 네트워크 브로드캐스트 어드레스 (브로드캐스트 지원x)
    - 총개수는 2^8 0 5 = 251

## 라우트 테이블

### 라우팅 방법
- CIDR 의 가변자리수
    - ex) 10.0.0.0/16 > 16

## 인터넷 게이트웨이
- VPC 가 외부의 인터넷과 통신할 수 있도록 경로를 만들어주는 리소스
- 기본적으로 확장성 , 고가용성 확보
- IPV4 , IPV6 지원
    - IPV4 경우 NAT 역할
- Route Table 에서 경로 설정 후에 접근 가능
- 무료
